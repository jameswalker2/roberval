import {useState, useRef} from "react";
import {auth} from './FirebaseConfig.jsx'
import {signInWithEmailAndPassword} from 'firebase/auth'
import imageRoberval from  '../assets/welcom_to_roberval.svg'
import './Login.scss'
import {useNavigate} from "react-router-dom";
// import {onAuthStateChange} from 'firebase/auth'
// import {NavBar} from "../header/NavBar.jsx";
// import {Link} from "react-router-dom";


export function Login() {

    const inputs = useRef([])
    const navigate = useNavigate();
    const formRef = useRef()
    const [validation, setValidation] = useState('')
    // const [loadingData, setLoadingData] = useState(true)


    const addInputs = el => {
        if(el && !inputs.current.includes(el)) {
            inputs.current.push(el)
        }
    }

    const connecter = (email, password) =>
        signInWithEmailAndPassword(auth, email, password)

    const handleSubmit = async (e) => {
        e.preventDefault()

        try {
              await connecter(
                inputs.current[0].value,
                inputs.current[1].value
            )
                formRef.current.reset();
                setValidation('')
                // setLoadingData(false)
                navigate('/accueil')
        } catch {
           setValidation('Email ou Password est incorrect')
        }

    }


    return (
    <>
    <div className="container_login">
        <div className="container_img">
            <img
                width="500"
                src={imageRoberval}
                alt="svg"
                id="img_roberval"/>
        </div>
        <div className="container_form">
                <form
                    ref={formRef}
                    onSubmit={handleSubmit}>
               <div className="container_form_title">
                    <h1 id="h1_ir">institution mixte Roberval </h1>
                    <h2 id="h2_s">Se connecter Ã  votre compte !</h2>
               </div>
               <div className="infield">
                   <svg width="30"  viewBox="0 0 40 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path fillRule="evenodd" clipRule="evenodd" d="M6 34.6667C4.4087 34.6667 2.88258 33.9818 1.75736 32.7629C0.632141 31.5439 0 29.8906 0 28.1667V6.5C0 4.77609 0.632141 3.12279 1.75736 1.90381C2.88258 0.68482 4.4087 0 6 0H34C35.5913 0 37.1174 0.68482 38.2426 1.90381C39.3679 3.12279 40 4.77609 40 6.5V28.1667C40 29.8906 39.3679 31.5439 38.2426 32.7629C37.1174 33.9818 35.5913 34.6667 34 34.6667H6ZM11.25 9.14333C11.0463 8.95487 10.8097 8.81267 10.5542 8.72517C10.2988 8.63767 10.0297 8.60666 9.76302 8.63398C9.49631 8.6613 9.23738 8.74638 9.00161 8.88419C8.76584 9.022 8.55802 9.20972 8.3905 9.4362C8.22298 9.66269 8.09917 9.92332 8.02642 10.2026C7.95367 10.482 7.93346 10.7743 7.96699 11.0622C8.00052 11.3502 8.08711 11.6279 8.22162 11.8789C8.35612 12.1299 8.53581 12.349 8.75 12.5233L16.25 19.0255C17.3142 19.9485 18.6368 20.4514 20 20.4514C21.3632 20.4514 22.6858 19.9485 23.75 19.0255L31.25 12.5255C31.4551 12.3477 31.6259 12.1278 31.7526 11.8785C31.8793 11.6291 31.9594 11.3552 31.9884 11.0723C32.0174 10.7895 31.9946 10.5032 31.9215 10.2298C31.8483 9.95645 31.7262 9.70138 31.562 9.47917C31.3978 9.25695 31.1949 9.07193 30.9647 8.93468C30.7346 8.79743 30.4817 8.71064 30.2206 8.67925C29.9595 8.64786 29.6952 8.6725 29.4429 8.75176C29.1906 8.83101 28.9551 8.96333 28.75 9.14117L21.25 15.6412C20.8953 15.9488 20.4544 16.1165 20 16.1165C19.5456 16.1165 19.1047 15.9488 18.75 15.6412L11.25 9.14117V9.14333Z" fill="#FFA901"/>
                   </svg>
                    <label htmlFor="email" id="email">Entrez votre Email</label>
                    <input
                        ref={addInputs}
                        type="email"
                        placeholder="youremail@gmail.com"
                    />
                    <label id="inline"></label>
               </div>
               <div className="infield">
                   <svg width="30"  viewBox="0 0 40 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M6.5 0C4.77609 0 3.12279 0.705119 1.90381 1.96024C0.684819 3.21536 0 4.91767 0 6.69268V22.1373C0 23.9123 0.684819 25.6146 1.90381 26.8698C3.12279 28.1249 4.77609 28.83 6.5 28.83H33.5C34.3536 28.83 35.1988 28.6569 35.9874 28.3206C36.7761 27.9842 37.4926 27.4912 38.0962 26.8698C38.6998 26.2483 39.1786 25.5105 39.5052 24.6985C39.8319 23.8865 40 23.0162 40 22.1373V6.69268C40 5.81378 39.8319 4.94349 39.5052 4.1315C39.1786 3.31951 38.6998 2.58171 38.0962 1.96024C37.4926 1.33877 36.7761 0.845789 35.9874 0.50945C35.1988 0.173112 34.3536 0 33.5 0H6.5ZM8.56 10.7495L10 12.2322L11.44 10.7495C11.5773 10.5977 11.7429 10.476 11.9269 10.3916C12.1109 10.3072 12.3096 10.2618 12.511 10.2581C12.7124 10.2545 12.9124 10.2926 13.0992 10.3703C13.286 10.448 13.4556 10.5636 13.5981 10.7103C13.7405 10.8569 13.8528 11.0316 13.9282 11.2239C14.0037 11.4162 14.0407 11.6222 14.0372 11.8296C14.0336 12.037 13.9895 12.2415 13.9076 12.431C13.8256 12.6204 13.7074 12.7909 13.56 12.9323L12.122 14.415L13.562 15.8936C13.7015 16.037 13.8121 16.2074 13.8876 16.3949C13.9632 16.5824 14.0021 16.7833 14.0022 16.9863C14.0023 17.1893 13.9635 17.3903 13.8882 17.5779C13.8128 17.7655 13.7023 17.9359 13.563 18.0795C13.4237 18.2231 13.2582 18.337 13.0761 18.4148C12.894 18.4926 12.6988 18.5326 12.5017 18.5327C12.3046 18.5328 12.1093 18.4929 11.9272 18.4154C11.745 18.3378 11.5795 18.224 11.44 18.0805L10 16.5978L8.56 18.0805C8.27565 18.3533 7.89956 18.5019 7.51095 18.4948C7.12235 18.4877 6.75158 18.3257 6.47676 18.0427C6.20193 17.7597 6.04451 17.3779 6.03765 16.9778C6.03079 16.5777 6.17504 16.1905 6.44 15.8977L7.88 14.415L6.44 12.9323C6.17504 12.6395 6.03079 12.2523 6.03765 11.8522C6.04451 11.4521 6.20193 11.0703 6.47676 10.7873C6.75158 10.5043 7.12235 10.3423 7.51095 10.3352C7.89956 10.3281 8.27565 10.4767 8.56 10.7495ZM19.56 10.7495L21 12.2322L22.44 10.7495C22.5773 10.5977 22.7429 10.476 22.9269 10.3916C23.1109 10.3072 23.3096 10.2618 23.511 10.2581C23.7124 10.2545 23.9124 10.2926 24.0992 10.3703C24.286 10.448 24.4556 10.5636 24.5981 10.7103C24.7405 10.8569 24.8528 11.0316 24.9282 11.2239C25.0037 11.4162 25.0407 11.6222 25.0372 11.8296C25.0336 12.037 24.9895 12.2415 24.9076 12.431C24.8256 12.6204 24.7074 12.7909 24.56 12.9323L23.122 14.415L24.562 15.8936C24.8434 16.1833 25.0015 16.5763 25.0015 16.986C25.0015 17.3958 24.8434 17.7887 24.562 18.0785C24.2806 18.3682 23.899 18.531 23.501 18.531C23.103 18.531 22.7214 18.3682 22.44 18.0785L21 16.5978L19.56 18.0805C19.4227 18.2323 19.2571 18.354 19.0731 18.4384C18.8891 18.5228 18.6904 18.5682 18.489 18.5719C18.2876 18.5755 18.0876 18.5374 17.9008 18.4597C17.714 18.382 17.5444 18.2664 17.4019 18.1197C17.2595 17.9731 17.1472 17.7984 17.0718 17.6061C16.9963 17.4138 16.9593 17.2078 16.9628 17.0004C16.9664 16.793 17.0105 16.5885 17.0924 16.399C17.1744 16.2096 17.2926 16.0391 17.44 15.8977L18.88 14.415L17.44 12.9323C17.175 12.6395 17.0308 12.2523 17.0376 11.8522C17.0445 11.4521 17.2019 11.0703 17.4768 10.7873C17.7516 10.5043 18.1224 10.3423 18.511 10.3352C18.8996 10.3281 19.2756 10.4767 19.56 10.7495ZM27.5 19.0484C27.5 18.6388 27.658 18.2459 27.9393 17.9563C28.2206 17.6666 28.6022 17.5039 29 17.5039H32.5C32.8978 17.5039 33.2794 17.6666 33.5607 17.9563C33.842 18.2459 34 18.6388 34 19.0484C34 19.458 33.842 19.8508 33.5607 20.1405C33.2794 20.4301 32.8978 20.5929 32.5 20.5929H29C28.6022 20.5929 28.2206 20.4301 27.9393 20.1405C27.658 19.8508 27.5 19.458 27.5 19.0484Z" fill="#FFA901"/>
                   </svg>
                    <label htmlFor="password" id="password" >Entrez votre Password</label>
                    <input
                        ref={addInputs}
                        type="password"
                        placeholder="*********"/>
                    <label id="inline" ></label>
               </div>
                   <p id="validation">{validation}</p>
                    <button   type="submit"> Connecter </button>
                </form>
        </div>
    </div>
        </>
    )
}